:root{
  --bg: #0c0c0d;
  --bg-elev: #171516;
  --ink: #e9e9ea;
  --ink-dim: #b7b7b9;
  --accent: #6aa3ff;
  --radius-xl: 28px;
  --shadow: 0 12px 60px rgba(0,0,0,.55);
  --shadow-strong: 0 18px 70px rgba(0,0,0,.65);
  --btn: #232224;
  --btn-hover: #2b292c;
  --suggest-bg: rgba(18,17,18,.9);
  --suggest-hover: #1d1b1e;

  --dock-top: 6vh;
  --bar-h: 60px;

  /* Shortcuts */
  --tile: 94px;
  --tile-gap: 10px;
  --tile-radius: 16px;
}

/* Base */
html, body {
  height: 100%;
  background-color: var(--bg);
  background-image: url("./wallpaper-dark.jpg");
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
  background-attachment: fixed;

  color: var(--ink);
  font: 16px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial,"Apple Color Emoji","Segoe UI Emoji";
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  margin: 0;
  overflow: hidden;
  overscroll-behavior: none;
}
body::before{
  content:"";
  position: fixed; inset: 0;
  background: radial-gradient(1200px 600px at 50% 35%, rgba(0,0,0,.25), rgba(0,0,0,.65) 70%);
  pointer-events: none;
  z-index: 0;
}

.dock {
  position: fixed;
  top: var(--dock-top);
  left: 50%;
  transform: translateX(-50%);
  width: min(820px, calc(100vw - 2rem));
  z-index: 10;
}

.bar {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 10px;
  background: rgba(16,14,15,.9);
  border-radius: var(--radius-xl);
  padding: 8px 10px;
  box-shadow: var(--shadow);
  position: relative;
  transition: box-shadow .15s ease, transform .15s ease;
  user-select: none;
}
.bar:focus-within { box-shadow: var(--shadow); }
.bar *:focus,
.bar *:focus-visible { outline: none !important; box-shadow: none !important; }

/* Input */
.form { display: contents; }
.q {
  width: 100%;
  height: 44px;
  padding: 0 6px;
  color: var(--ink);
  background: transparent;
  border: none;
  outline: none;
  font-size: 1.05rem;
  caret-color: var(--accent);
}
.q::placeholder { color: var(--ink-dim); opacity: .6; }

/* Action cluster (right side) */
.actions {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--bg-elev);
  height: 44px;
  padding: 0 6px 0 10px;
  border-radius: 999px;
}
.btn {
  width: 36px; height: 36px;
  display: grid; place-items: center;
  border-radius: 999px;
  background: var(--btn);
  color: var(--ink);
  border: 0;
  cursor: pointer;
  transition: transform .12s ease, background-color .12s ease, opacity .12s ease;
}
.btn:hover { background: var(--btn-hover); }
.btn:active { transform: scale(.96); }
.btn[disabled] { opacity: .45; cursor: not-allowed; }

/* Voice recording pulse */
.voice.recording {
  background: #2f2c32;
  box-shadow: 0 0 0 0 rgba(106,163,255,.35);
  animation: pulse 1.2s infinite;
}
@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(106,163,255,.35); }
  70% { box-shadow: 0 0 0 10px rgba(106,163,255,0); }
  100% { box-shadow: 0 0 0 0 rgba(106,163,255,0); }
}

.lens { width: 40px; height: 40px; }
.lens svg { width: 20px; height: 20px; }

.ai { width: 44px; height: 44px; margin-left: 4px; }

.suggest {
  position: absolute;
  left: 0; right: 0;
  top: calc(100% + 10px);
  margin: 0;
  padding: 8px;
  list-style: none;
  background: var(--suggest-bg);
  border-radius: 16px;
  box-shadow: 0 10px 40px rgba(0,0,0,.6);
  max-height: calc(100vh - var(--dock-top) - var(--bar-h) - 20px);
  overflow-x: hidden;
  display: none;
  z-index: 9;
}
.suggest.show { display: block; }
.suggest li {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  border-radius: 10px;
  color: var(--ink);
  cursor: pointer;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.suggest li:hover,
.suggest li.active { background: var(--suggest-hover); }
.s-icon { width: 18px; height: 18px; opacity: .7; }

@media (prefers-reduced-motion: reduce) { .btn { transition: none; } }

/* Shortcuts */
.shortcuts {
  position: fixed;
  top: calc(var(--dock-top) + var(--bar-h) + 18px);
  left: 50%;
  transform: translateX(-50%);
  width: min(900px, calc(100vw - 2rem));
  background: rgba(16,14,15,.88);
  border-radius: 20px;
  box-shadow: var(--shadow);
  padding: 10px 12px 12px;
  z-index: 5;
  user-select: none;
}
.shortcuts .sc-bar{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; padding: 2px 2px 8px;
}
.shortcuts .sc-title{
  font-size:.9rem; color:var(--ink-dim); letter-spacing:.02em;
  opacity:.85;
}
.shortcuts .sc-actions{
  display:flex; align-items:center; gap:6px;
  background: var(--bg-elev);
  border-radius: 999px;
  padding: 3px;
}
.btn.tiny{ width:32px; height:32px; }

.tiles{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--tile), 1fr));
  gap: var(--tile-gap);
  margin: 0; padding: 0; list-style: none; /* alignment fix: remove default ul spacing */
}
.tile{
  position:relative;
  background: var(--btn);
  border: 1px solid rgba(255,255,255,.04);
  border-radius: var(--tile-radius);
  height: var(--tile);
  padding: 8px 8px;
  display:grid;
  grid-template-rows: 1fr auto;
  align-items:center; justify-items:center;
  cursor:pointer;
  transition: background-color .12s ease, transform .12s ease;
}
.tile:hover{ background: var(--btn-hover); }
.tile.dragging{ opacity: .5; }
.tile .favicon{
  width: 28px; height: 28px; border-radius: 6px;
  background: #2a2a2c; display:grid; place-items:center;
  overflow:hidden;
}
.tile .favicon img{ width:100%; height:100%; object-fit:cover; display:block; }
.tile .label{
  width: 100%;
  font-size: .78rem; color: var(--ink); opacity: .96;
  text-align:center; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* In-tile actions (Edit + Delete) */
.tile .action{
  position:absolute; top:6px;
  width: 24px; height: 24px;
  display:none; place-items:center;
  border-radius: 8px;
  background: var(--btn);
  border: 1px solid rgba(255,255,255,.06);
  color: var(--ink);
  cursor: pointer;
  transition: background-color .12s ease, opacity .12s ease, transform .12s ease;
}
.tile .action:hover{ background: var(--btn-hover); }
.tile .edit{ right: 34px; }
.tile .remove{ right: 6px; }
.tile .action svg{
  width: 14px; height: 14px; display:block;
  stroke-linecap: round; stroke-linejoin: round;
}
.shortcuts.edit .tile .action,
.folder-view.edit .tile .action { display:grid; }

/* Folder tile icon */
.tile.folder .favicon { background: transparent; }
.tile.folder .folder-ico{
  width: 28px; height: 28px; display:grid; place-items:center;
}
.tile.folder .folder-ico svg{
  width: 26px; height: 26px; opacity: .95;
}
.tile.folder .count{
  position:absolute; bottom:6px; right:6px;
  font-size:.7rem; color: var(--ink-dim); opacity:.8;
}

/* Folder view overlay */
.folder-view{
  position:absolute; inset: 8px;
  background: rgba(18,17,18,.95);
  border-radius: 16px;
  box-shadow: var(--shadow-strong);
  display:none;
  grid-template-rows: auto 1fr;
  padding: 10px;
  z-index: 6;
  overflow: hidden;
}
.folder-view.show{ display:grid; }
.folder-view .fv-bar{
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  padding: 2px 2px 8px;
}
.folder-view .fv-left{
  display:flex; align-items:center; gap:8px;
}
.folder-view .fv-title{
  font-size:.95rem; color: var(--ink); font-weight: 600; letter-spacing:.02em;
}
.folder-view .fv-actions{
  display:flex; align-items:center; gap:6px;
  background: var(--bg-elev);
  border-radius: 999px;
  padding: 3px;
}
.folder-view .fv-grid{
  overflow: auto; /* internal scroll */
  -webkit-overflow-scrolling: touch;
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--tile), 1fr));
  gap: var(--tile-gap);
  margin: 0; padding: 0; list-style: none; /* alignment fix inside folder */
}

/* Dialog + overlay */
.overlay{
  position: fixed; inset: 0;
  background: rgba(0,0,0,.4);
  display:none; z-index: 20;
}
.overlay.show{ display:block; }
.sc-dialog{
  position: fixed; left: 50%; top: 50%;
  transform: translate(-50%,-50%);
  width: min(420px, calc(100vw - 2rem));
  background: rgba(18,17,18,.95);
  border-radius: 18px;
  box-shadow: var(--shadow-strong);
  padding: 14px;
  display:none; z-index: 21;
}
.sc-dialog.show{ display:block; }
.sc-dialog h3{
  margin: 6px 4px 12px; font-size: 1rem; font-weight: 600;
  color: var(--ink);
}
.sc-dialog .row{
  display:flex; flex-direction:column; gap:6px; margin: 10px 4px;
}
.sc-dialog label{ font-size:.85rem; color: var(--ink-dim); }
.sc-dialog input, .sc-dialog select{
  height: 38px; border-radius: 10px; border: 1px solid rgba(255,255,255,.06);
  background: #1b191c; color: var(--ink); padding: 0 10px;
  outline:none;
}
.sc-dialog .actions{
  display:flex; justify-content:flex-end; gap:8px; margin-top: 12px;
}
.sc-dialog .btn{
  width: auto; min-width: 88px;
  height: 36px; padding: 0 14px;
  display: inline-flex; align-items: center; justify-content: center;
  white-space: nowrap;
}
.sc-dialog .btn.primary{
  background: #2b2a2f; color: var(--ink); border-radius: 10px;
}
.sc-dialog .btn.ghost{
  background: transparent; border: 1px solid rgba(255,255,255,.08);
  color: var(--ink); border-radius: 10px;
}

@media (max-width: 520px){
  :root { --tile: 86px; }
  .shortcuts { width: min(680px, calc(100vw - 1.5rem)); }
}